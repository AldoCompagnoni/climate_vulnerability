# extract Capdevila's values
library(raster)
library(tidyverse)
library(rworldmap)

# plot world map of ------------------------------
sPDF       <- getMap()
tm         <- raster( 'results/tmean_sd.tif' )
mat        <- raster( 'data/mat.tif' )
ext_na     <- c(-160, -50, 15, 70)
ext_e      <- c( -10, 50, 30, 65 ) 

tm_na      <- crop( tm, ext_na ) / 10
tm_e       <- crop( tm, ext_e ) / 10

# plot North American and europe
png( 'results/mean/na_tmean_sd.png',
     width = 6.3, height = 6.3,
     unit = 'in', res = 600 )
plot( tm_na )
plot( sPDF, add = T)
dev.off()


png( 'results/mean/e_tmean_sd.png',
     width = 6.3, height = 6.3,
     unit = 'in', res = 600 )

plot(tm_e, col=rainbow(100), legend=FALSE, axes=FALSE)
plot( sPDF, add = T )
plot(tm_e, col=rainbow(100),
     legend.only=TRUE, 
     legend.width=1, legend.shrink=0.75,
     legend.cex=2,
     axis.args=list(at       = seq(0.4, 1.4, 0.2),
                    labels   = seq(0.4, 1.4, 0.2),
                    cex.axis = 2) )

dev.off()


# MAT ------------------------------------------------------

mat_na      <- crop( mat, ext_na ) / 10
mat_e       <- crop( mat, ext_e ) / 10

png( 'results/mean/e_mat.png',
      width = 6.3, height = 6.3,
      unit = 'in', res = 600 )
plot( mat_e )
plot( sPDF, add = T)
dev.off()
