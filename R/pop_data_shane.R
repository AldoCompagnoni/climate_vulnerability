library(tidyverse)
options(stringsAsFactors = F)

# biotime data
biotime_all    <- read.csv( 'BioTime_example.csv' ) 

# Question 1: Are different spatial replicates contained in the SAMPLE_DESC column?

# Identical LATITUDE/LONGITUDE values correspond to several rows from the same year.
biotime_all %>% 
  subset( STUDY_ID == 214 & GENUS_SPECIES == 'Picea sitchensis') %>% 
  subset( LATITUDE == 47.785 & LONGITUDE == -123.9182 )

# Is this due to the fact that SAMPLE_DESC contains several spatial replicates?
# here, it seems that HSGY_HR01_2, HSGY_HR01_3, HSGY_HR01_4... 
# refer to different unique spatial reps
biotime_all %>% 
  subset( STUDY_ID == 214 & GENUS_SPECIES == 'Picea sitchensis') %>% 
  subset( grepl('HSGY_HR01_4',SAMPLE_DESC) )


# Question 2: Do separate rows correwspond to the same plot?

# Example: in 1972, there are 63 data points. 
# I worked on the original dataset, and these are 63 separate individuals contained in two plots.
# These plots are "e1q4-2" and "e1q4-1". This plot information is contained in SAMPLE_DESC.
# Note, in SAMPLE_DESC, but not in the PLOT column.
# E.g. "13.2542191_19.2748775_1972_e1q4-272" refers to plot "e1q4-2" in year 1972.
# 
# Is there a way to "unpack" the SAMPLE_DESC column to get this spatial replicate information?

biotime_all %>%
  subset( STUDY_ID == 298 & GENUS_SPECIES == 'Lesquerella ovalifolia') %>%
  subset( YEAR == 1972 ) %>%
  head

